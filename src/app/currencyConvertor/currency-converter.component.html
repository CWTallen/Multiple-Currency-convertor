<div class="currency-converter">
  <div class="container">
    <h1 class="title">Multi-Currency Exchange Rate Converter</h1>

    <!-- 金额输入 -->
    <div class="input-group">
      <label>Amount：</label>
      <input type="number" [(ngModel)]="amount" min="0"/>
    </div>

    <!-- 基础货币选择 -->
    <div class="direction-selector">
      <label>Base Currency：</label>
      <select [(ngModel)]="baseCurrency" (change)="onBaseCurrencyChange()">
        <option *ngFor="let cur of availableCurrencies" [value]="cur">{{ cur }}</option>
      </select>
    </div>

    <!-- 目标货币选择 -->
    <div class="currency-selection">
      <label>Select target currencies to display：</label>
      <div class="currency-grid">
        <div class="currency-item" *ngFor="let cur of availableCurrencies" [class.disabled]="cur === baseCurrency"
             (click)="toggleCurrency(cur)">
          <input type="checkbox" [(ngModel)]="selectedCurrencies[cur]" (change)="saveSelectedCurrencies()"
                 [disabled]="cur === baseCurrency" (click)="$event.stopPropagation()"/>
          <span> {{ cur }}  </span>
        </div>
      </div>
    </div>

    <!-- 刷新按钮 -->
    <button class="refresh-button" (click)="forceRefreshRates()">
      Refresh Rates
    </button>

    <!-- 加载提示 -->
    <div *ngIf="loading" class="loading">Loading exchange rates...</div>

    <!-- 速率限制警告 -->
    <div *ngIf="this.rateLimitError" class="rate-limit-warning">
      ⚠️ Rate limit reached. Using cached data. Please wait before refreshing again.
    </div>

    <!-- 汇率显示 -->
    <div *ngIf="!loading" class="rates-display">
      <div class="rate-item" *ngFor="let item of displayRates">
        <span class="currency-code">{{ item.label }}</span>
        <span class="converted-amount">{{ (amount * item.value) | number:'1.2-2':'en-US' }}</span>
        <span class="rate-info">(1 {{ baseCurrency }} = {{ item.value | number:'1.4-4':'en-US' }} {{ item.label }}
          )</span>
      </div>
    </div>

    <!-- 更新时间 -->
    <div *ngIf="!loading && lastUpdated" class="last-updated">
      Last updated at: {{ lastUpdated | date:'medium' }} (automatically refreshed every 5 minutes)
    </div>

    <div class="api-credit">
      Real-time exchange rate data from fxratesapi.com
    </div>
  </div>
</div>
